import os

def merge_grid_files(input_files, output_file):
    total_points = 0
    total_x = []
    total_y = []

    for file in input_files:
        with open(file, 'r') as f:
            header = f.readline().strip()
            N, M = map(int, header.split())
            total_points += N * M
            
            for line in f:
                x, y = map(float, line.strip().split())
                total_x.append(x)
                total_y.append(y)

    # Записываем результирующий файл
    with open(output_file, 'w') as out_file:
        out_file.write(f"{len(total_x)} {len(total_y)}\n")
        for x, y in zip(total_x, total_y):
            out_file.write(f"{x} {y}\n")




def merge_results_files(input_files, output_file):
    flat_results = []

    for file in input_files:
        with open(file, 'r') as f:
            header = f.readline().strip()
            N, M = map(int, header.split())
            result_count = N * M
            
            for line in f:
                result_value = line.strip()
                flat_results.append(result_value)

    # Записываем результирующий файл
    with open(output_file, 'w') as out_file:
        total_N = len(flat_results)
        total_M = 1  # Поскольку мы просто собираем один результат в строку
        out_file.write(f"{total_N} {total_M}\n")
        for result in flat_results:
            out_file.write(f"{result}\n")



input_grid_files = ['./results_MPI/grid0.txt', './results_MPI/grid1.txt']
output_grid_file = 'merged_grid.txt'

input_result_files = ['./results_MPI/res0.txt', './results_MPI/res1.txt']
output_result_file = 'merged_results.txt'

merge_grid_files(input_grid_files, output_grid_file)
merge_results_files(input_result_files, output_result_file)